<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C13T3P2</title>
    <style>
        /* --- Basic Setup & Typography --- */
        :root {
            --primary-bg: #f0f2f5;
            --secondary-bg: #ffffff;
            --text-color: #1c1e21;
            --accent-color: #0866ff;
            --border-color: #dddfe2;
            --highlight-bg: #fffb8f;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
            --footer-bg: #ffffff;
            --shadow-light: 0 1px 2px rgba(0, 0, 0, 0.1);
            --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color);
            overflow: hidden;
            /* Prevent body scroll */
        }

        /* --- Main Layout --- */
        .main-container {
            display: flex;
            height: calc(100vh - 50px);
            /* Full height minus footer */
        }

        .panel {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            box-sizing: border-box;
            background-color: var(--secondary-bg);
            margin: 10px;
            border-radius: 12px;
            box-shadow: var(--shadow-light);
        }

        .panel-left {
            margin-right: 5px;
        }

        .panel-right {
            margin-left: 5px;
            display: flex;
            flex-direction: column;
        }

        /* --- Content Styling --- */
        .question-section {
            margin-bottom: 25px;
        }

        .instructions {
            font-style: italic;
            background-color: #f7f7f7;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .excursion-title {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--accent-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 5px;
            margin-bottom: 15px;
        }

        .question-list {
            list-style-type: none;
            padding-left: 0;
            line-height: 2.2;
        }

        .question-list li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .question-text {
            display: block;
            margin-bottom: 5px;
        }

        .question-options {
            padding-left: 20px;
            font-size: 0.9em;
            color: #555;
            line-height: 1.6;
        }

        .question-list li::before {
            content: '●';
            position: absolute;
            left: 0;
            top: 0; /* Aligns with the input */
            color: var(--accent-color);
        }

        .answer-input {
            border: none;
            border-bottom: 1px solid var(--border-color);
            background-color: transparent;
            font-size: 1em;
            font-family: inherit;
            margin: 0 5px;
            padding: 2px 5px;
            width: 80px; /* Shorter for A/B/C */
            text-align: center;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .answer-input:focus {
            outline: none;
            border-bottom: 2px solid var(--accent-color);
        }
        
        .matching-box {
            background-color: #f7f7f7;
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .correct-answer-span {
            font-weight: bold;
            color: var(--correct-color);
            margin-left: 10px;
        }

        audio {
            width: 100%;
            margin-bottom: 20px;
        }

        /* --- Right Panel: Notes & Transcript --- */
        #notes-area {
            width: 100%;
            height: 30%;
            /* 1/3 of the right panel */
            min-height: 150px;
            box-sizing: border-box;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            font-size: 1em;
            font-family: inherit;
            margin-bottom: 20px;
            resize: vertical;
        }

        #transcript-container {
            flex-grow: 1;
            overflow-y: auto;
            line-height: 1.7;
            display: none;
            /* Initially hidden */
        }

        #transcript-container p {
            margin-bottom: 1em;
        }

        /* --- Footer --- */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background-color: var(--footer-bg);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            /* Align items to ends */
            padding: 0 20px;
            box-sizing: border-box;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05);
            z-index: 1000;
        }

        .footer-group {
            display: flex;
            align-items: center;
        }

        .footer-btn,
        .nav-btn {
            border: none;
            padding: 8px 15px;
            margin: 0 4px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: opacity 0.2s, transform 0.2s;
        }

        .footer-btn:hover,
        .nav-btn:hover {
            opacity: 0.85;
            transform: translateY(-1px);
        }

        #submit-btn {
            background-color: #28a745;
            color: white;
        }

        #answers-btn {
            background-color: #ffc107;
            color: var(--text-color);
        }

        #redo-btn {
            background-color: #dc3545;
            color: white;
        }

        #transcript-btn {
            background-color: #17a2b8;
            color: white;
        }

        .nav-btn {
            background-color: #e4e6eb;
            color: var(--text-color);
            min-width: 35px;
            height: 35px;
            padding: 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .encoded-by {
            font-size: 14px;
            color: #606770;
            font-weight: 500;
        }

        /* --- Modals (Password & Results) --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: none;
            /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.3s;
        }

        .modal-content {
            background: var(--secondary-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-medium);
            text-align: center;
            width: 320px;
        }

        .modal-content p {
            margin-top: 0;
            font-size: 1.1em;
            font-weight: 600;
        }

        #results-text {
            font-size: 1.5em !important;
            font-weight: 700 !important;
            color: var(--accent-color);
            margin: 20px 0;
        }

        #password-input {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-sizing: border-box;
        }

        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            margin: 0 5px;
        }

        #modal-submit-btn,
        #results-close-btn {
            background-color: var(--accent-color);
            color: white;
        }

        #modal-cancel-btn {
            background-color: #e4e6eb;
        }

        /* --- Custom Context Menu & Highlighting --- */
        #contextMenu {
            display: none;
            position: absolute;
            z-index: 3000;
            background-color: var(--secondary-bg);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-medium);
            border-radius: 8px;
            padding: 5px 0;
            min-width: 160px;
        }

        #contextMenu div {
            padding: 10px 15px;
            cursor: pointer;
        }

        #contextMenu div:hover {
            background-color: var(--primary-bg);
        }

        .highlight {
            background-color: var(--highlight-bg);
            border-radius: 3px;
            padding: 1px 0;
        }
    </style>
</head>

<body>

    <div class="main-container">
        <!-- Left Panel: Questions -->
        <div class="panel panel-left">
            <audio controls>
                <source src="./c13t3p2.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>

            <div class="question-section">
                <div class="instructions">
                    <b>SECTION 2</b><br>
                    <i>Questions 11-16:</i> What advantage does the speaker mention for each of the following physical
                    activities?<br>
                    Choose <b>SIX</b> answers from the box and write the correct letter, <b>A-G</b>, next to Questions
                    11-16.
                </div>

                <div class="matching-box">
                    <b>Advantages</b><br>
                    A. not dependent on season<br>
                    B. enjoyable<br>
                    C. low risk of injury<br>
                    D. fitness level unimportant<br>
                    E. sociable<br>
                    F. fast results<br>
                    G. motivating
                </div>

                <ul class="question-list">
                    <li data-question-id="11"><b>11.</b> using a gym <input type="text" class="answer-input"
                            data-question-id="11"></li>
                    <li data-question-id="12"><b>12.</b> running <input type="text" class="answer-input"
                            data-question-id="12"></li>
                    <li data-question-id="13"><b>13.</b> swimming <input type="text" class="answer-input"
                            data-question-id="13"></li>
                    <li data-question-id="14"><b>14.</b> cycling <input type="text" class="answer-input"
                            data-question-id="14"></li>
                    <li data-question-id="15"><b>15.</b> doing yoga <input type="text" class="answer-input"
                            data-question-id="15"></li>
                    <li data-question-id="16"><b>16.</b> training with a personal trainer <input type="text"
                            class="answer-input" data-question-id="16"></li>
                </ul>

                <div class="instructions" style="margin-top: 25px;">
                    <i>Questions 17 and 18:</i> Choose <b>TWO</b> letters, <b>A-E</b>.<br>
                    For which <b>TWO</b> reasons does the speaker say people give up going to the gym?
                </div>
                <div class="question-options" style="padding-left: 0; line-height: 1.8;">
                    A. lack of time<br>
                    B. loss of confidence<br>
                    C. too much effort required<br>
                    D. high costs<br>
                    E. feeling less successful than others
                </div>
                <b>17.</b> <input type="text" class="answer-input" data-question-id="17">
                <b>18.</b> <input type="text" class="answer-input" data-question-id="18">

                <div class="instructions" style="margin-top: 25px;">
                    <i>Questions 19 and 20:</i> Choose <b>TWO</b> letters, <b>A-E</b>.<br>
                    Which <b>TWO</b> pieces of advice does the speaker give for setting goals?
                </div>
                <div class="question-options" style="padding-left: 0; line-height: 1.8;">
                    A. write goals down<br>
                    B. have achievable aims<br>
                    C. set a time limit<br>
                    D. give yourself rewards<br>
                    E. challenge yourself
                </div>
                <b>19.</b> <input type="text" class="answer-input" data-question-id="19">
                <b>20.</b> <input type="text" class="answer-input" data-question-id="20">
                
            </div>
        </div>

        <!-- Right Panel: Notes and Transcript -->
        <div class="panel panel-right">
            <textarea id="notes-area" placeholder="Take your notes here..."></textarea>
            <div id="transcript-container">
                <h3>Transcript</h3>
                <p>So if you are one of those people who hasn’t found the perfect physical activity yet, here are some
                    things to think about which might help you make the right decision for you. The first question to
                    ask yourself is whether you would enjoy training in a gym. Many people are put off by the idea of
                    having to fit a visit to the gym into their busy day. You often have to go very early or late as some
                    gyms can get very crowded but with regular training you’ll see a big difference in a relatively short
                    space of time. (Q11)</p>
                <p>Running has become incredibly popular in recent years. That’s probably got a lot to do with the fact
                    that it’s a very accessible form of exercise that anyone can run even if you could only run a few
                    meters to begin with (Q12). But make sure you get the right shoes. It’s worth investing in a high
                    quality pair and they don’t come cheap. Another great thing about running is that you can do it at
                    any time of day or night. The only thing that may stop you is snow and ice.</p>
                <p>Swimming is another really good way to build fitness. What attracts many people is that you can swim
                    in an indoor pool at any time of year (Q13). On the other hand, it can be quite boring or solitary.
                    It’s hard to chat to people while you’re swimming lengths.</p>
                <p>Cycling has become almost as popular as running in recent years. That’s probably because as well as
                    improving their fitness many people say being out in the fresh air in a park or in the countryside
                    can be fun (Q14), provided the conditions are right of course. Only fanatics go out in the wind and
                    rain.</p>
                <p>Yoga is a good choice for those of you looking for exercise, which focuses on developing both a
                    healthy mind and body. It’s a good way of building strength and with the right instructor there’s
                    less chance of hurting yourself than with other more active sports (Q15). But don’t expect to find
                    it easy. It can be surprisingly challenging, especially for people who aren’t very flexible. Getting
                    a personal trainer is a good way to start your fitness program. Obviously there can be significant
                    costs involved. But if you’ve got someone there to encourage you and help you achieve your goals,
                    you’re less likely to give up. Make sure you get someone with a recognised qualification though. Or
                    you could do yourself permanent damage. (Q16)</p>
                <p>Whatever you do, don’t join a gym and you’re sure you’ll make good use of it. So many people waste
                    lots of money by signing up for membership and then hardly ever go. What happens to their good
                    intentions? I don’t think people suddenly stop caring about improving their fitness or decide they
                    have more important things to do. I think people lose interest when they don’t think they’re making
                    enough progress. That’s when they give up hope and stop believing they’ll ever achieve their goals
                    (Q17/Q18). Also, what people sometimes don’t realize when they start is that it takes a lot of
                    determination and hard work to keep training week after week, and lots of people don’t have that kind
                    of commitment (Q17/Q18).</p>
                <p>One thing you can do to help yourself is to set manageable goals (Q19/Q20), be realistic and don’t
                    push yourself too far. Some people advise writing goes down but I think it’s better to have a
                    flexible approach. Give yourself a really nice treat every time you reach one of your goals (Q19/Q20)
                    and don’t get too upset if you experience setbacks. It’s a journey. There are bound to be
                    difficulties along the way.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <!-- Left Group -->
        <div class="footer-group">
            <span class="encoded-by">Encoded by Dinh Phuoc</span>
        </div>
        <!-- Center Group (Nav Buttons) -->
        <div class="footer-group" id="nav-buttons">
            <!-- Navigation buttons will be generated here by JS -->
        </div>
        <!-- Right Group (Action Buttons) -->
        <div class="footer-group">
            <button id="submit-btn" class="footer-btn">Submit</button>
            <button id="answers-btn" class="footer-btn">Answers</button>
            <button id="redo-btn" class="footer-btn">Redo</button>
            <button id="transcript-btn" class="footer-btn">Transcript</button>
        </div>
    </footer>

    <!-- Password Modal -->
    <div id="password-modal" class="modal-overlay">
        <div class="modal-content">
            <p id="modal-title">Enter Password</p>
            <input type="password" id="password-input">
            <button id="modal-submit-btn" class="modal-btn">Confirm</button>
            <button id="modal-cancel-btn" class="modal-btn">Cancel</button>
        </div>
    </div>

    <!-- Results Modal -->
    <div id="results-modal" class="modal-overlay">
        <div class="modal-content">
            <p>Your Score</p>
            <p id="results-text"></p>
            <button id="results-close-btn" class="modal-btn">Close</button>
        </div>
    </div>

    <!-- Custom Context Menu -->
    <div id="contextMenu">
        <div onclick="highlightText()">Highlight</div>
        <div onclick="removeHighlightsInRange()">Remove Highlight</div>
    </div>


    <script>
        // --- CONFIGURATION --- //
        const CORRECT_PASSWORD = "1231"; // Change password here
        const answers = {
            '11': ["f"],
            '12': ["d"],
            '13': ["a"],
            '14': ["b"],
            '15': ["c"],
            '16': ["g"],
            '17': ["c", "e"], // C and E are interchangeable for 17/18
            '18': ["e", "c"], // C and E are interchangeable for 17/18
            '19': ["b", "d"], // B and D are interchangeable for 19/20
            '20': ["d", "b"]  // B and D are interchangeable for 19/20
        };

        // --- DOM ELEMENT REFERENCES --- //
        const allInputs = document.querySelectorAll('.answer-input');
        const submitBtn = document.getElementById('submit-btn');
        const answersBtn = document.getElementById('answers-btn');
        const redoBtn = document.getElementById('redo-btn');
        const transcriptBtn = document.getElementById('transcript-btn');
        const transcriptContainer = document.getElementById('transcript-container');
        const navButtonsContainer = document.getElementById('nav-buttons');

        // Password Modal
        const passwordModal = document.getElementById('password-modal');
        const passwordInput = document.getElementById('password-input');
        const modalSubmitBtn = document.getElementById('modal-submit-btn');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');
        const modalTitle = document.getElementById('modal-title');

        // Results Modal
        const resultsModal = document.getElementById('results-modal');
        const resultsText = document.getElementById('results-text');
        const resultsCloseBtn = document.getElementById('results-close-btn');

        let passwordCallback = null;

        // --- INITIALIZATION --- //
        window.onload = function () {
            // Clear input fields on load
            allInputs.forEach(element => {
                element.autocomplete = "off";
                element.value = "";
            });

            // Generate navigation buttons
            // Need to get unique question IDs first for 17/18 and 19/20
            const questionIds = [...new Set(Array.from(allInputs).map(el => el.dataset.questionId))];
            questionIds.sort((a, b) => parseInt(a) - parseInt(b));
            
            questionIds.forEach(id => {
                const btn = document.createElement('button');
                btn.className = 'nav-btn';
                btn.textContent = id;
                btn.onclick = () => {
                    // Find the first element with this ID (for scrolling)
                    const element = document.querySelector(`[data-question-id='${id}']`);
                    if (element) {
                        // Find parent <li> or the input itself
                        const scrollTarget = element.closest('li') || element;
                        if (scrollTarget) {
                            scrollTarget.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        }
                        // Focus the input
                        if (element.tagName === 'INPUT') {
                             element.focus();
                        } else {
                            // If it's a wrapper, find the input inside
                             const input = element.querySelector('input');
                             if(input) input.focus();
                        }
                    }
                };
                navButtonsContainer.appendChild(btn);
            });
        };

        // --- SECURITY & ANTI-CHEAT --- //
        document.addEventListener("keydown", function (e) {
            if (e.key === "F12" ||
                (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J" || e.key === "C")) ||
                (e.ctrlKey && (e.key === "U" || e.key === "P" || e.key === "S"))) {
                e.preventDefault();
            }
        });

        // --- HIGHLIGHTING LOGIC --- //
        let selectedRange = null;

        document.addEventListener("contextmenu", (e) => {
            e.preventDefault();
            const selection = window.getSelection();
            if (selection.toString().trim()) {
                selectedRange = selection.getRangeAt(0);
                showContextMenu(e.clientX, e.clientY);
            }
        });

        document.addEventListener("click", () => {
            hideContextMenu();
        });

        function showContextMenu(x, y) {
            const menu = document.getElementById("contextMenu");
            menu.style.display = "block";
            menu.style.left = x + window.scrollX + "px";
            menu.style.top = y + window.scrollY + "px";
        }

        function hideContextMenu() {
            document.getElementById("contextMenu").style.display = "none";
        }

        function highlightText() {
            if (selectedRange) {
                const span = document.createElement("span");
                span.className = "highlight";
                try {
                    selectedRange.surroundContents(span);
                } catch (e) {
                    console.error("Cannot highlight partial nodes.", e);
                }
                hideContextMenu();
            }
        }

        function removeHighlightsInRange() {
            if (!selectedRange) return;
            const range = selectedRange.cloneRange();
            let commonAncestor = range.commonAncestorContainer;
            if (commonAncestor.nodeType === Node.TEXT_NODE) {
                commonAncestor = commonAncestor.parentNode;
            }
            const highlights = commonAncestor.querySelectorAll(".highlight");
            highlights.forEach(function (span) {
                if (range.intersectsNode(span)) {
                    while (span.firstChild) {
                        span.parentNode.insertBefore(span.firstChild, span);
                    }
                    span.parentNode.removeChild(span);
                }
            });
            window.getSelection().removeAllRanges();
            hideContextMenu();
        }


        // --- CORE FUNCTIONALITY --- //
        function clearResults() {
            allInputs.forEach(input => {
                input.style.borderColor = "";
                input.style.borderBottom = "1px solid var(--border-color)";
                input.style.backgroundColor = "transparent"; // Clear background
                const nextEl = input.nextElementSibling;
                if (nextEl && nextEl.classList.contains('correct-answer-span')) {
                    nextEl.remove();
                }
            });
        }
        
        // Helper function to check answers for multiple-choice groups
        function checkMultipleChoiceGroup(ids) {
            const userValues = [];
            const correctValues = answers[ids[0]].map(v => v.toLowerCase());
            let allCorrect = true;
            let correctCount = 0;

            ids.forEach(id => {
                const input = document.querySelector(`[data-question-id='${id}']`);
                const userValue = input.value.trim().toLowerCase();
                
                if (userValue) {
                     userValues.push(userValue);
                }

                if (correctValues.includes(userValue)) {
                    input.style.borderBottom = "2px solid var(--correct-color)";
                    correctCount++;
                } else if (userValue !== "") { // Only mark wrong if it's not empty
                    input.style.borderBottom = "2px solid var(--incorrect-color)";
                    allCorrect = false;
                } else {
                     allCorrect = false; // Empty field means not all correct
                }
            });

            // Check if all provided answers are correct and unique
            const userSet = new Set(userValues);
            if (userSet.size !== correctValues.length || userValues.length !== correctValues.length) {
                allCorrect = false;
            }
            
            userValues.forEach(val => {
                 if(!correctValues.includes(val)) {
                     allCorrect = false;
                 }
            });

            // If all are correct, return true, otherwise return the count
            return allCorrect ? true : correctCount;
        }


        submitBtn.addEventListener('click', () => {
            clearResults();
            let correctCount = 0;
            
            // Handle multi-choice groups
            const groups = {
                '17': ['17', '18'],
                '19': ['19', '20']
            };
            const processedIds = new Set();

            allInputs.forEach(input => {
                const questionId = input.dataset.questionId;
                if (processedIds.has(questionId)) return; // Skip if already processed in a group

                if (groups[questionId]) {
                    const groupIds = groups[questionId];
                    const result = checkMultipleChoiceGroup(groupIds);
                    if (result === true) {
                        correctCount += groupIds.length;
                    } else {
                         correctCount += result; // Add partial correct count
                    }
                    groupIds.forEach(id => processedIds.add(id));
                } else {
                    // Handle single questions (11-16)
                    const userValue = input.value.trim().toLowerCase();
                    const correctValues = answers[questionId].map(v => v.toLowerCase());

                    if (correctValues.includes(userValue)) {
                        input.style.borderBottom = "2px solid var(--correct-color)";
                        correctCount++;
                    } else {
                        input.style.borderBottom = "2px solid var(--incorrect-color)";
                    }
                }
            });

            resultsText.textContent = `${correctCount} / ${allInputs.length}`;
            resultsModal.style.display = 'flex';
        });


        redoBtn.addEventListener('click', () => {
            clearResults();
            allInputs.forEach(input => {
                input.value = "";
            });
            document.getElementById('notes-area').value = "";
        });

        function showAnswers() {
            clearResults();
            const answeredIds = new Set();

            allInputs.forEach(input => {
                const questionId = input.dataset.questionId;
                if(answeredIds.has(questionId)) return;
                
                const correctValues = answers[questionId];
                
                if (correctValues.length > 1) { // Handle multi-answer questions
                     const inputs = document.querySelectorAll(`[data-question-id='${questionId}']`);
                     inputs.forEach((inp, index) => {
                         if(correctValues[index]) {
                             inp.value = correctValues[index].toUpperCase();
                             inp.style.borderBottom = "2px solid var(--correct-color)";
                             answeredIds.add(inp.dataset.questionId); // Add specific ID
                         }
                     });
                     // Handle grouped IDs like 17/18
                     if (questionId === '17') {
                         document.querySelector(`[data-question-id='18']`).value = correctValues[1].toUpperCase();
                         document.querySelector(`[data-question-id='18']`).style.borderBottom = "2px solid var(--correct-color)";
                         answeredIds.add('18');
                     }
                     if (questionId === '19') {
                         document.querySelector(`[data-question-id='20']`).value = correctValues[1].toUpperCase();
                         document.querySelector(`[data-question-id='20']`).style.borderBottom = "2px solid var(--correct-color)";
                         answeredIds.add('20');
                     }

                } else { // Handle single-answer questions
                    input.value = correctValues[0].toUpperCase();
                    input.style.borderBottom = "2px solid var(--correct-color)";
                    answeredIds.add(questionId);
                }
            });
        }

        // --- MODAL LOGIC --- //
        function askForPassword(purpose, callback) {
            modalTitle.textContent = `Enter Password to ${purpose}`;
            passwordModal.style.display = 'flex';
            passwordInput.focus();
            passwordCallback = callback;
        }

        function closeModal(modal) {
            modal.style.display = 'none';
        }

        // Password Modal Listeners
        answersBtn.addEventListener('click', () => {
            askForPassword("Show Answers", showAnswers);
        });

        transcriptBtn.addEventListener('click', () => {
            if (transcriptContainer.style.display === 'block') {
                transcriptContainer.style.display = 'none';
                transcriptBtn.textContent = 'Show Transcript';
            } else {
                askForPassword("Show Transcript", () => {
                    transcriptContainer.style.display = 'block';
                    transcriptBtn.textContent = 'Hide Transcript';
                });
            }
        });

        modalSubmitBtn.addEventListener('click', handlePasswordSubmit);
        passwordInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                handlePasswordSubmit();
            }
        });

        function handlePasswordSubmit() {
            if (passwordInput.value === CORRECT_PASSWORD) {
                if (typeof passwordCallback === 'function') {
                    passwordCallback();
                }
                closeModal(passwordModal);
                passwordInput.value = '';
                passwordCallback = null;
            } else {
                alert('Incorrect Password!');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }

        modalCancelBtn.addEventListener('click', () => {
            closeModal(passwordModal);
            passwordInput.value = '';
            passwordCallback = null;
        });

        // Results Modal Listeners
        resultsCloseBtn.addEventListener('click', () => closeModal(resultsModal));

        // Close modal if clicking outside of the content
        window.addEventListener('click', (e) => {
            if (e.target === passwordModal) closeModal(passwordModal);
            if (e.target === resultsModal) closeModal(resultsModal);
        });

    </script>
</body>

</html>