<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>IELTS Listening Practice - Exercise 4</title>
    <style>
        /* --- RESET & BASIC STYLES --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            line-height: 1.6;
            font-size: 16px;
            color: #333;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* --- HEADER --- */
        .header {
            background-color: #ffffff;
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            height: 60px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .timer-container {
            display: flex;
            align-items: center;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .timer-controls button {
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .contact-link {
            color: #4a90e2;
            text-decoration: none;
            font-weight: bold;
        }

        /* --- MAIN CONTAINER --- */
        .main-container {
            margin-top: 80px;
            margin-bottom: 100px;
            display: flex;
            justify-content: center;
            padding: 0 20px;
        }

        .listening-panel {
            background: #ffffff;
            width: 100%;
            max-width: 800px;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            min-height: 600px;
        }

        /* --- TABS --- */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 25px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            color: #4a90e2;
            background-color: #f9f9f9;
        }

        .tab-btn.active {
            color: #4a90e2;
            border-bottom: 3px solid #4a90e2;
        }

        .part-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .part-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- AUDIO --- */
        .audio-player-container {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        audio {
            width: 100%;
            outline: none;
        }

        /* --- QUESTIONS --- */
        .instruction {
            background: #eef2f7;
            padding: 12px 15px;
            border-left: 4px solid #4a90e2;
            margin-bottom: 20px;
            font-weight: 500;
            color: #2c3e50;
        }

        .question-block {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .q-badge {
            background: #4a90e2;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .answer-input {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px 10px;
            font-size: 16px;
            width: 250px;
            transition: border-color 0.3s;
        }

        .answer-input:focus {
            border-color: #4a90e2;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        /* --- CHECKBOX STYLES (Q5-7) --- */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-left: 40px; /* Align with text */
        }

        .checkbox-option {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .checkbox-option:hover {
            background: #f0f0f0;
        }

        .checkbox-option input {
            margin-top: 5px;
            margin-right: 12px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .option-letter {
            font-weight: bold;
            margin-right: 5px;
            min-width: 20px;
        }

        /* --- FEEDBACK STYLES --- */
        .correct {
            border-color: #28a745 !important;
            background-color: #e9f7ef !important;
            color: #155724;
        }

        .incorrect {
            border-color: #dc3545 !important;
            background-color: #f8d7da !important;
            color: #721c24;
        }

        .checkbox-option.correct-option {
            background-color: #e9f7ef;
            border: 1px solid #c3e6cb;
        }
        
        .checkbox-option.missed-option {
            background-color: #fff3cd; /* Yellow for missed correct answers */
            border: 1px solid #ffeeba;
        }

        .correct-answer-display {
            margin-left: 10px;
            font-weight: bold;
            color: #28a745;
            font-size: 14px;
        }

        /* --- FOOTER NAVIGATION --- */
        .nav-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
            border-top: 1px solid #e0e0e0;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
            z-index: 100;
        }

        .nav-items {
            display: flex;
            gap: 5px;
            overflow-x: auto;
        }

        .nav-btn {
            width: 35px;
            height: 35px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover { background-color: #f0f0f0; }
        .nav-btn.answered { background-color: #e3f2fd; border-color: #64b5f6; color: #1565c0; }
        .nav-btn.correct { background-color: #28a745; color: white; border-color: #28a745; }
        .nav-btn.incorrect { background-color: #dc3545; color: white; border-color: #dc3545; }
        .nav-btn.partial { background-color: #ffc107; color: #333; border-color: #ffc107; } /* For checkbox partial score */

        .submit-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .submit-btn:hover { background-color: #357abd; }

        /* --- MODAL & TRANSCRIPT --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active { display: flex; }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            border-radius: 8px;
            padding: 25px;
            overflow-y: auto;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            background: none;
            border: none;
            color: #888;
        }

        .score-box {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .transcript-container {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #eee;
            font-size: 15px;
        }

        .highlight-text {
            color: #d35400;
            font-weight: bold;
            background-color: #fff3e0;
            padding: 0 2px;
        }

        .transcript-section-title {
            color: #2c3e50;
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
            text-decoration: underline;
        }

    </style>
</head>
<body>

    <!-- Header -->
    <div class="header">
        <div class="timer-container">
            <i class="fa-regular fa-clock" style="margin-right: 10px;"></i>
            <span id="timer">30:00</span>
            <div class="timer-controls">
                <button id="timer-toggle"><i class="fa-solid fa-pause"></i></button>
            </div>
        </div>
        <a href="https://www.facebook.com/DinhPhuocIELTS/" target="_blank" class="contact-link">Đình Phước Edu</a>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <div class="listening-panel">
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchPart(1)">Questions 1-4</button>
                <button class="tab-btn" onclick="switchPart(2)">Questions 5-7</button>
                <button class="tab-btn" onclick="switchPart(3)">Questions 8-10</button>
            </div>

            <!-- Part 1: Q1-4 -->
            <div id="part1" class="part-content active">
                <div class="audio-player-container">
                    <audio controls controlsList="nodownload">
                        <source src="listening-practice-4-1.mp3" type="audio/mp3">
                    </audio>
                </div>
                <div class="instruction">
                    Complete the notes. Write NO MORE THAN TWO WORDS for each answer.
                </div>
                
                <div class="question-block">
                    <div class="input-wrapper">
                        <span class="question-text" style="width: 100px;">Job:</span>
                        <div class="q-badge">1</div>
                        <input type="text" class="answer-input" id="q1" placeholder="answer">
                        <span style="margin-left: 10px;">for five years</span>
                    </div>
                    <div class="input-wrapper">
                        <span class="question-text" style="width: 100px;">Studied:</span>
                        <div class="q-badge">2</div>
                        <input type="text" class="answer-input" id="q2" placeholder="answer">
                        <span style="margin-left: 10px;">at university</span>
                    </div>
                    <div class="input-wrapper">
                        <span class="question-text" style="width: 100px;">Interested in:</span>
                        <div class="q-badge">3</div>
                        <input type="text" class="answer-input" id="q3" placeholder="answer">
                        <span style="margin-left: 10px;">side, not theory</span>
                    </div>
                    <div class="input-wrapper">
                        <span class="question-text" style="width: 100px;">Accepted for:</span>
                        <div class="q-badge">4</div>
                        <input type="text" class="answer-input" id="q4" placeholder="answer">
                        <span style="margin-left: 10px;">after graduating</span>
                    </div>
                </div>
            </div>

            <!-- Part 2: Q5-7 -->
            <div id="part2" class="part-content">
                <div class="audio-player-container">
                    <audio controls controlsList="nodownload">
                        <source src="listening-practice-4-2.mp3" type="audio/mp3">
                    </audio>
                </div>
                <div class="instruction">
                    Questions 5-7: Choose THREE answers from A-F.
                </div>
                
                <div class="question-block">
                    <p class="question-text">What does the speaker think are the disadvantages of police work?</p>
                    <div class="checkbox-group" id="q5-7-group">
                        <label class="checkbox-option" data-val="A">
                            <input type="checkbox" value="A">
                            <span class="option-letter">A.</span>
                            <span>danger of being attacked</span>
                        </label>
                        <label class="checkbox-option" data-val="B">
                            <input type="checkbox" value="B">
                            <span class="option-letter">B.</span>
                            <span>protecting the public</span>
                        </label>
                        <label class="checkbox-option" data-val="C">
                            <input type="checkbox" value="C">
                            <span class="option-letter">C.</span>
                            <span>not being available for family celebrations</span>
                        </label>
                        <label class="checkbox-option" data-val="D">
                            <input type="checkbox" value="D">
                            <span class="option-letter">D.</span>
                            <span>special training in avoiding trouble</span>
                        </label>
                        <label class="checkbox-option" data-val="E">
                            <input type="checkbox" value="E">
                            <span class="option-letter">E.</span>
                            <span>working difficult hours</span>
                        </label>
                        <label class="checkbox-option" data-val="F">
                            <input type="checkbox" value="F">
                            <span class="option-letter">F.</span>
                            <span>working with the public</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Part 3: Q8-10 -->
            <div id="part3" class="part-content">
                <div class="audio-player-container">
                    <audio controls controlsList="nodownload">
                        <source src="listening-practice-4-3.mp3" type="audio/mp3">
                    </audio>
                </div>
                <div class="instruction">
                    Answer the questions. Write NO MORE THAN TWO WORDS.
                </div>

                <div class="question-block">
                    <p class="question-text">What does the speaker think about the financial rewards of police work?</p>
                    <div class="input-wrapper">
                        <div class="q-badge">8</div>
                        <input type="text" class="answer-input" id="q8" placeholder="answer">
                    </div>
                </div>

                <div class="question-block">
                    <p class="question-text">What kind of people do the police sometimes have to protect?</p>
                    <div class="input-wrapper">
                        <div class="q-badge">9</div>
                        <input type="text" class="answer-input" id="q9" placeholder="answer">
                    </div>
                </div>

                <div class="question-block">
                    <p class="question-text">What does the speaker want to be in the future?</p>
                    <div class="input-wrapper">
                        <div class="q-badge">10</div>
                        <input type="text" class="answer-input" id="q10" placeholder="answer">
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Navigation Footer -->
    <div class="nav-row">
        <div class="nav-items">
            <!-- Dynamically generated or manual -->
            <button class="nav-btn" onclick="jumpToQ(1, 1)">1</button>
            <button class="nav-btn" onclick="jumpToQ(2, 1)">2</button>
            <button class="nav-btn" onclick="jumpToQ(3, 1)">3</button>
            <button class="nav-btn" onclick="jumpToQ(4, 1)">4</button>
            <button class="nav-btn" onclick="jumpToQ(5, 2)">5-7</button> <!-- Combined nav for multi-select -->
            <button class="nav-btn" onclick="jumpToQ(8, 3)">8</button>
            <button class="nav-btn" onclick="jumpToQ(9, 3)">9</button>
            <button class="nav-btn" onclick="jumpToQ(10, 3)">10</button>
        </div>
        <button class="submit-btn" id="submit-btn">
            <i class="fa fa-check"></i> Submit Answers
        </button>
    </div>

    <!-- Result Modal -->
    <div class="modal-overlay" id="result-modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div class="score-box">
                <h2>Result</h2>
                <div style="font-size: 36px; font-weight: bold; color:#4a90e2;">
                    <span id="user-score">0</span> / 10
                </div>
            </div>
            
            <div class="transcript-container">
                <h3><i class="fa-solid fa-file-lines"></i> Transcript & Key</h3>
                
                <div class="transcript-section-title">Part 1 (Q1-4)</div>
                <p>Hello, everyone. Thank you for inviting me to give a talk in this series of employment lectures. I’m here this evening to tell you about my job... OK … Well, I’m a <span class="highlight-text">police officer (1)</span>.</p>
                <p>I’ve been in the police for just over five years... I’ve always been interested in law and order, so I went to study <span class="highlight-text">law (2)</span> at university. But ... mmm ... when I got there I realized that I was more interested in the <span class="highlight-text">practical (3)</span> side of law than the theory.</p>
                <p>So, I applied to work with the police force in my spare time. Then, as soon as I graduated, I was accepted for <span class="highlight-text">training (4)</span>.</p>

                <div class="transcript-section-title">Part 2 (Q5-7)</div>
                <p>As you know, our job is to protect the public from criminals and defend the law. So, obviously, the police force has to work every day of the week, day and night. This means we’re often at work when everyone else is relaxing... and we can’t always <span class="highlight-text">be around for special occasions (6 - C)</span>, like birthdays and New Year’s Eve. On top of that we have a lot of extra work at weekends... So our <span class="highlight-text">working hours (7 - E)</span> are one disadvantage of police work.</p>
                <p>A lot of the time we have to work with the public... But we can’t always prevent trouble, so another disadvantage of the job is the <span class="highlight-text">danger (5 - A)</span>… I mean, we know that some of the people we have to arrest will attack us.</p>

                <div class="transcript-section-title">Part 3 (Q8-10)</div>
                <p>Now for the advantages … Well, one of the advantages is that police work is <span class="highlight-text">well‐paid (8)</span>.</p>
                <p>But there are many more advantages … for example sometimes the work’s fun, especially when we have to protect <span class="highlight-text">famous people (9)</span> from their own fans! I’ve met quite a lot of celebrities...</p>
                <p>But, for me the biggest advantage is the job satisfaction... And in the future, I’d like to train to be <span class="highlight-text">a detective (10)</span>. I think I’d be good at that.</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- SECURITY ---
            document.addEventListener("keydown", function (e) {
                if (
                    e.key === "F12" ||
                    (e.ctrlKey && e.shiftKey && e.key === "I") ||
                    (e.ctrlKey && e.shiftKey && e.key === "J") ||
                    (e.ctrlKey && e.shiftKey && e.key === "C") ||
                    (e.ctrlKey && e.key === "u") ||
                    (e.ctrlKey && e.key === "p") ||
                    (e.ctrlKey && e.key === "s")
                ) {
                    e.preventDefault();
                    return false;
                }
            });
            document.addEventListener('contextmenu', event => event.preventDefault());

            // --- DATA ---
            const answers = {
                1: ['police officer'],
                2: ['law'],
                3: ['practical'],
                4: ['training'],
                // 5-7 handled specially
                8: ['well-paid', 'well paid'],
                9: ['famous people', 'celebrities', 'celebrity'],
                10: ['a detective', 'detective']
            };
            const multiSelectCorrect = ['A', 'C', 'E']; // For 5, 6, 7

            // --- STATE ---
            let timeInSeconds = 1800;
            let timerInterval;
            let isPaused = false;

            // --- TIMER ---
            function updateTimer() {
                if (isPaused) return;
                timeInSeconds--;
                let m = Math.floor(timeInSeconds / 60);
                let s = timeInSeconds % 60;
                document.getElementById('timer').innerText = 
                    `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                
                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    submitAnswers();
                }
            }
            timerInterval = setInterval(updateTimer, 1000);
            
            document.getElementById('timer-toggle').addEventListener('click', function() {
                isPaused = !isPaused;
                this.innerHTML = isPaused ? '<i class="fa-solid fa-play"></i>' : '<i class="fa-solid fa-pause"></i>';
            });

            // --- TRACKING ANSWERS FOR NAV ---
            document.querySelectorAll('input[type="text"]').forEach(input => {
                input.addEventListener('input', () => {
                    const id = input.id.replace('q', '');
                    const btn = document.querySelector(`.nav-btn[onclick*="jumpToQ(${id}"]`);
                    if(btn) {
                        if(input.value.trim()) btn.classList.add('answered');
                        else btn.classList.remove('answered');
                    }
                });
            });

            // Tracking for Multi-select Q5-7
            const checkboxes = document.querySelectorAll('#q5-7-group input');
            checkboxes.forEach(cb => {
                cb.addEventListener('change', () => {
                    const checked = document.querySelectorAll('#q5-7-group input:checked').length;
                    const btn = document.querySelector(`.nav-btn[onclick*="jumpToQ(5"]`);
                    if(checked > 0) btn.classList.add('answered');
                    else btn.classList.remove('answered');
                });
            });

            // --- FUNCTIONS ---
            window.switchPart = function(partId) {
                // Update Tabs
                document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
                    btn.classList.toggle('active', (idx + 1) === partId);
                });
                // Update Content
                document.querySelectorAll('.part-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('part' + partId).classList.add('active');
                
                // Pause other audios
                document.querySelectorAll('audio').forEach(audio => audio.pause());
            }

            window.jumpToQ = function(qNum, partId) {
                switchPart(partId);
                // Scroll if needed inside the panel? Not really needed for short parts, 
                // but we can focus the input.
                if (qNum >= 5 && qNum <= 7) {
                    // Checkboxes don't need focus in the same way
                } else {
                    setTimeout(() => {
                        document.getElementById('q' + qNum).focus();
                    }, 100); // small delay for tab switch
                }
            }

            window.submitAnswers = function() {
                clearInterval(timerInterval);
                let score = 0;

                // Disable inputs
                document.querySelectorAll('input').forEach(i => i.disabled = true);
                
                // 1. Check Text Inputs (Q1-4, 8-10)
                const textQs = [1, 2, 3, 4, 8, 9, 10];
                textQs.forEach(qId => {
                    const input = document.getElementById('q' + qId);
                    const userVal = input.value.trim().toLowerCase().replace(/\s+/g, ' ');
                    const correctVals = answers[qId].map(v => v.toLowerCase());
                    const btn = document.querySelector(`.nav-btn[onclick*="jumpToQ(${qId}"]`);

                    if (correctVals.includes(userVal) && userVal !== '') {
                        score++;
                        input.classList.add('correct');
                        if(btn) { btn.classList.remove('answered'); btn.classList.add('correct'); }
                    } else {
                        input.classList.add('incorrect');
                        if(btn) { btn.classList.remove('answered'); btn.classList.add('incorrect'); }
                        
                        // Show Answer
                        const span = document.createElement('span');
                        span.className = 'correct-answer-display';
                        span.innerText = `✓ ${answers[qId][0]}`;
                        input.parentNode.appendChild(span);
                    }
                });

                // 2. Check Multi-Select (Q5-7)
                // Logic: 1 point for each correct checkbox. Max 3 points total for this section.
                let multiScore = 0;
                document.querySelectorAll('#q5-7-group .checkbox-option').forEach(label => {
                    const checkbox = label.querySelector('input');
                    const val = checkbox.value;
                    const isCorrectOption = multiSelectCorrect.includes(val);

                    if (checkbox.checked) {
                        if (isCorrectOption) {
                            multiScore++;
                            label.classList.add('correct');
                        } else {
                            label.classList.add('incorrect');
                        }
                    } else {
                        // If it was a correct option but NOT checked
                        if (isCorrectOption) {
                            label.classList.add('missed-option'); // Visual clue
                        }
                    }
                });
                
                score += multiScore;
                
                // Color the nav button for 5-7 based on performance
                const multiBtn = document.querySelector(`.nav-btn[onclick*="jumpToQ(5"]`);
                multiBtn.classList.remove('answered');
                if (multiScore === 3) multiBtn.classList.add('correct');
                else if (multiScore === 0) multiBtn.classList.add('incorrect');
                else multiBtn.classList.add('partial');

                // Show Modal
                document.getElementById('user-score').innerText = score;
                document.getElementById('result-modal').classList.add('active');
                
                // Change submit button
                const subBtn = document.getElementById('submit-btn');
                subBtn.innerHTML = '<i class="fa fa-eye"></i> Results';
                subBtn.onclick = () => document.getElementById('result-modal').classList.add('active');
            }

            // --- EVENT LISTENER FOR SUBMIT BUTTON ADDED HERE ---
            document.getElementById('submit-btn').addEventListener('click', submitAnswers);

            window.closeModal = function() {
                document.getElementById('result-modal').classList.remove('active');
            }

        });
    </script>
</body>
</html>